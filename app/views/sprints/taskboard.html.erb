<script>
$(document).on('turbolinks:load', function() {
	
	var observer = new MutationObserver(function(mutations) {
  mutations.forEach(function(mutation) {
    console.log('Mutation type: ' + mutation.type);
    if ( mutation.type == 'childList' ) {
      if (mutation.addedNodes.length >= 1) {
      	$('#modal').modal('toggle');
		$('#modal').modal('show');
      }
      else if (mutation.removedNodes.length >= 1) {
        //window.alert("jojo");
      }
    }
    else if (mutation.type == 'attributes') {
       //window.alert('jiji');
    }
        });   
});
  
var observerConfig = {
        attributes: true,
        subtree: true,
        childList: true,
        characterData: true
};
  
// Listen to all changes to body and child nodes
var targetNode = document.getElementById('div_id');
observer.observe(targetNode, observerConfig);
});
</script> 

<style type="text/css">

	.left {float: left;}
	.right {float: right;}

	.clear,.clearer {clear: both;}
	.clearer {
		display: block;
		font-size: 0;
		height: 0;
		line-height: 0;
	}

	.ui-sortable {
		margin: 0;
		padding: 0;
	}
	#accordion .ui-accordion-content { padding: 0; }

/*
	Example specifics
	------------------------------------------------------------------- */


	/* Columns */

	.column {
		margin-left: 2%;
		width: 32%;
	}

	.column.first {margin-left: 0;}


	/* Sortable items */

	.sortable-list {
		overflow: auto;
		list-style: none;
		min-height: 60px;
		background-color: #3cadd4;
	}


	.backlog-table ul{
		list-style: none;
	}



	.sortable-item{
		border-bottom: 1px solid #515050;
		cursor: move;
		color: white;  
		height: 50px;  
		padding: .3rem 0 .3rem .3rem;
		text-align: center;
		width: 100%;
		background-color: #3cadd4;
	} 



	/* Item placeholder (visual helper) */

	.placeholder {
		background-color: grey;
		border: 1px dashed #666;
		height: 25px;
		margin-bottom: 5px;
	}

	.sprint-table,.backlog-table li:hover{

		background-color: #bcbcbc;
	}

.boardColumn {
    display: table-cell;
    overflow: auto;
}

	.scrollTabla {
	     overflow:scroll;
	     overflow-x: hidden;
	     height:500px;
	    
	}
	
}
</style>



<script>

$(document).on('turbolinks:load', function() {



	$('.new-task').on('click', function(e) {
    e.preventDefault();
    $('#myModal').modal('show');
	});



	$( "#accordion" ).accordion({
			heightStyle: "content" 
		});


    	$('.sortable-list').sortable({
			connectWith: '.sortable-list',
			placeholder: 'placeholder',

			receive	 : function(ev, ui) {
				console.log("nuevo elemento recibido ");
				$("#accordion").accordion( "refresh" );
			}

		});



});
</script>

<div class="supreme-container">
<section id="main" class="wrapper">
	<header class="major">
		<h2><%= @sprint.sprint_nombre %> - Tablero de Tareas</h2>
	</header>


	<div class= "container">
			<div class="isa_info">
	    		<i class="fa fa-info-circle"></i>
	    			Tareas creadas para realizar el sprint 'insertar aqui el sprint'
				</div>
				</br>


		   <div class="scrollTabla">
				<table class="tablaTareas table table-hover" width="500" >
					<tr>
						<th>Historia de Usuario</th>
						<th>Nueva</th>
						<th>En Proceso</th>
						<th>Test</th>
						<th>Completada</th>
					</tr>				
				<% for historia in @historias do %>
					<tr>
						<td align="left" valign="top">
									
									<tr>
									<td align="left" valign="center" style="text-align: center; float: left;">
										<p><%= historia.His_Nombre %></p>
										
										<%= link_to tarea_new_path(:id => @sprint.id, :historia_id => historia.id),  :remote => true,  class:"button button styleIcon" do %>
										Nueva Tarea<%= image_tag("ic_add_white.png", :class => "iconImage")%>
									<% end %>
										
									</td>
									<td>
									<ul class="sortable-list">							
										<% for tarea in @tareas %>
											<% if tarea.Estado=="Nueva" && tarea.historiausuario_id==historia.id %>
											<li class="sortable-item">
													<div class="row" style="float:top;padding-left: 1em; padding-right: 1em;">
																<p align="center"><%= tarea.Asunto %></p>
																<%= link_to tarea_edit_path(:id => tarea.id),  :remote => true, class:"button styleIconSmall float_right" do %>
								<%= image_tag("ic_edit_white.png", :class => "iconImageSmall")%>
								<% end %>				
													</div>
											</li>
											<% end %>
										<% end %>
									</ul>
									</td>
									<td>
									<ul class="sortable-list">							
										<% for tarea in @tareas %>
											<% if tarea.Estado=="En Proceso" && tarea.historiausuario_id==historia.id %>
											<li class="sortable-item">
													<div class="row" style="float:top;padding-left: 1em; padding-right: 1em;">
																<p align="center"><%= tarea.Asunto %></p>
																<%= link_to tarea_edit_path(:id => tarea.id),  :remote => true, class:"button styleIconSmall float_right" do %>
								<%= image_tag("ic_edit_white.png", :class => "iconImageSmall")%>
								<% end %>				
													</div>
											</li>
											<% end %>
										<% end %>
									</ul>
									</td>
									<td>
									<ul class="sortable-list">							
										<% for tarea in @tareas %>
											<% if tarea.Estado=="Test" && tarea.historiausuario_id==historia.id %>
											<li class="sortable-item">
													<div class="row" style="float:top;padding-left: 1em; padding-right: 1em;">
																<p align="center"><%= tarea.Asunto %></p>
																<%= link_to tarea_edit_path(:id => tarea.id),  :remote => true, class:"button styleIconSmall float_right" do %>
								<%= image_tag("ic_edit_white.png", :class => "iconImageSmall")%>
								<% end %>				
													</div>
											</li>
											<% end %>
										<% end %>
									</ul>
									</td>
									<td>
									<ul class="sortable-list">							
										<% for tarea in @tareas %>
											<% if tarea.Estado=="Completada" && tarea.historiausuario_id==historia.id %>
											<li class="sortable-item">
													<div class="row" style="float:top;padding-left: 1em; padding-right: 1em;">
																<p align="center"><%= tarea.Asunto %></p>
																<%= link_to tarea_edit_path(:id => tarea.id),  :remote => true, class:"button styleIconSmall float_right" do %>
								<%= image_tag("ic_edit_white.png", :class => "iconImageSmall")%>
								<% end %>				
													</div>
											</li>
											<% end %>
										<% end %>
									</ul>
									</td>

									</tr>				
						</td>
						</tr>
					<%end%>					

				</table>

			</div>
			
				
		</div>



	</section>
</div>

 <div id="div_id">
	</div>

														
